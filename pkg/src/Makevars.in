## -*- mode: makefile; -*-
## Configure tells us about locations for
## both Rcpp (ie libRcpp.so and Rcpp.h) and 
## ProtoBuf headers and library
PKG_CPPFLAGS=		@PKG_CPPFLAGS@
PKG_LIBS=		@PKG_LIBS@

pkg=			RProtoBuf

all:			addressbook.pb.cc pkglib

addressbook.pb.cc:	addressbook.proto
			protoc --cpp_out=. $<

addressbook.pb.o:	addressbook.pb.cc
			$(SHLIB_CXXLD) -c $< $(CXXPICFLAGS) $(SHLIB_CXXLDFLAGS) $(PKG_CPPFLAGS) 

pkglib:			addressbook.pb.o list_people_R.o rprotobuf.o lookup.o
			$(SHLIB_CXXLD) -o $(pkg)$(DYLIB_EXT) $^ $(SHLIB_CXXLDFLAGS) $(PKG_LIBS)


